apiVersion: meta.k8s.appscode.com/v1alpha1
kind: ResourceOutline
metadata:
  creationTimestamp: null
  labels:
    k8s.io/group: kubedb.com
    k8s.io/kind: MongoDB
    k8s.io/resource: mongodbs
    k8s.io/version: v1alpha2
  name: kubedb-kubedb.com-v1alpha2-mongodbs
spec:
  header:
    actions:
      create: Never
    displayMode: Field
    kind: Connection
    query:
      byLabel: view
      type: GraphQL
    ref:
      group: ui.k8s.appscode.com
      kind: GenericResource
  tabBar:
    actions:
      create: Never
    displayMode: Field
    kind: Connection
    query:
      byLabel: view
      type: GraphQL
    ref:
      group: ui.k8s.appscode.com
      kind: GenericResourceService
  pages:
  - name: Overview
    info:
      actions:
        create: Never
      displayMode: List
      kind: Connection
      query:
        byLabel: offshoot
        type: GraphQL
      ref:
        group: appcatalog.appscode.com
        kind: AppBinding
    insight:
      actions:
        create: Never
      displayMode: Field
      kind: Connection
      query:
        byLabel: view
        type: GraphQL
      ref:
        group: ui.kubedb.com
        kind: MongoDBInsight
    blocks:
    # - actions:
    #     create: Never
    #   displayMode: List
    #   kind: Connection
    #   query:
    #     raw: |
    #       request:
    #         target:
    #           group: kubedb.com
    #           kind: MongoDB
    #           name: {{ .metadata.name }}
    #           namespace: {{ .metadata.namespace }}
    #         dashboard:
    #           title: "<xyz>"
    #         panels: []
    #     type: REST
    #   ref:
    #     group: ui.openviz.dev
    #     kind: EmbeddedDashboard
    - actions:
        create: Never
      displayMode: List
      kind: Connection
      query:
        raw: |-
          query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
            find(oid: $src) {
              offshoot(group: "", kind: "Pod") {
                refs: view(group: $targetGroup, kind: $targetKind) {
                  namespace
                  name
                }
              }
            }
          }
        type: GraphQL
      ref:
        group: ui.k8s.appscode.com
        kind: PodView
  - name: Database Insights
    info:
      actions:
        create: Never
      displayMode: Field
      kind: Connection
      query:
        byLabel: view
        type: GraphQL
      ref:
        group: ui.kubedb.com
        kind: MongoDBInsight
    blocks:
    - actions:
        create: Never
      displayMode: Field
      kind: Connection
      fieldPath: .spec.queries
      view:
        name: ui.kubedb.com-v1alpha1-mongodbqueries-queries
      query:
        byLabel: view
        type: GraphQL
      ref:
        group: ui.kubedb.com
        kind: MongoDBQueries
    - actions:
        create: Never
      displayMode: Field
      kind: Connection
      fieldPath: .spec.collections
      view:
        name: ui.kubedb.com-v1alpha1-mongodbschemaoverviews-collections
      query:
        byLabel: view
        type: GraphQL
      ref:
        group: ui.kubedb.com
        kind: MongoDBSchemaOverview
    # - actions:
    #     create: Never
    #   displayMode: List
    #   kind: Connection
    #   query:
    #     raw: |
    #       request:
    #         target:
    #           group: kubedb.com
    #           kind: MongoDB
    #           name: {{ .metadata.name }}
    #           namespace: {{ .metadata.namespace }}
    #         dashboard:
    #           title: "<xyz>"
    #         panels: []
    #     type: REST
    #   ref:
    #     group: ui.openviz.dev
    #     kind: EmbeddedDashboard
  - name: Backups
    info:
      actions:
        create: IfEmpty
      displayMode: Field
      kind: Connection
      query:
        raw: |-
          query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
            find(oid: $src) {
              backup_via(group: "stash.appscode.com", kind: "BackupConfiguration") {
                refs: view(group: $targetGroup, kind: $targetKind) {
                  namespace
                  name
                }
              }
            }
          }
        type: GraphQL
      ref:
        group: ui.stash.appscode.com
        kind: BackupOverview
    blocks:
    - actions:
        create: Always
      displayMode: List
      kind: Connection
      query:
        raw: |-
          query Find($src: String!, $targetGroup: String!, $targetKind: String!) {
            find(oid: $src) {
              backup_via(group: "stash.appscode.com", kind: "BackupConfiguration") {
                refs: offshoot(group: $targetGroup, kind: $targetKind) {
                  namespace
                  name
                }
              }
            }
          }
        type: GraphQL
      ref:
        group: stash.appscode.com
        kind: BackupSession
  - name: Operations
    blocks:
    - actions:
        create: Always
      displayMode: List
      kind: Connection
      query:
        byLabel: offshoot
        type: GraphQL
      ref:
        group: ops.kubedb.com
        kind: MongoDBOpsRequest
  # - name: Alerts
  #   blocks:
  #   - kind: Block
  #     name: kubedb.com-v1alpha2-monitoring
  resource:
    group: kubedb.com
    kind: MongoDB
    name: mongodbs
    scope: Namespaced
    version: v1alpha2
  ui:
    editor:
      name: kubedbcom-mongodb-editor
      url: https://bundles.byte.builders/ui/
      version: v0.3.0
    options:
      name: kubedbcom-mongodb-editor-options
      url: https://bundles.byte.builders/ui/
      version: v0.3.0
